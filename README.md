# SPC Generator

![Version](https://img.shields.io/badge/version-5.0.0-blue) ![Python](https://img.shields.io/badge/python-3.9%2B-green) ![License](https://img.shields.io/badge/license-MIT-lightgrey)

**Automated Process Capability & Attribute Analysis Tool**

The SPC Generator is a powerful automation tool for Quality and Manufacturing Engineers. It processes raw inspection data from Excel‚Äîwhether **Numerical measurements** or **Pass/Fail attributes**‚Äîand generates professional PDF reports, control charts, and statistical summaries without manual calculation.

**New in v5.0:** Now features a full **Graphical User Interface (GUI)** for easier file management, project organization, and real-time logging.

---

## üöÄ Key Features

* **üñ•Ô∏è User-Friendly Dashboard:** A clean, windowed interface to manage your files and runs. No more black command prompt windows.
* **‚ö° Zero-Setup Batch Processing:** Select 1 or 100 Excel files and process them all at once.
* **üìÇ Smart Project Management:**
    * Create new project folders for fresh runs.
    * Select existing project folders to append or overwrite data.
* **üìä Variable & Attribute Support:**
    * **Numeric:** Automatically calculates Cp, Cpk, Mean, and Standard Deviation.
    * **Attribute:** Automatically detects text (e.g., "Pass", "Fail", "OK", "NOK") and calculates Failure Rates.
* **üö® Automatic Anomaly Detection:** Scans data against **Standard WECO Rules** to detect instability and trends.
* **üìë "Audit-Ready" Reports:** Generates PDF "White Papers" with Histograms (for numeric) or Bar Charts (for attributes).

---

## üõ†Ô∏è How It Works

1.  **Input:** You fill out the Excel template (generated by the tool).
    * **Numeric:** Enter measurements (e.g., `10.05`, `10.06`).
    * **Attribute:** Enter text (e.g., `Pass`, `Fail`).
2.  **Process:** The tool scans each column.
    * It detects if limits are absolute (e.g., `10.05`) or tolerances (e.g., `0.05`) and standardizes them.
    * It determines if the feature is Numeric or Attribute based on content.
3.  **Analyze:**
    * **Numeric:** Runs standard distribution analysis and WECO rules.
    * **Attribute:** Calculates yield and plots a Step Chart (1 vs 0).
4.  **Output:** Results are saved in `output/Your_Project_Name/`.

---

## üèÅ Quick Start

### 1. Installation
1.  Install [Python 3.9+](https://www.python.org/downloads/) (Check **"Add to PATH"**).
2.  Double-click **`install.bat`** to set up the local environment.
    * *Wait for the green "SUCCESS" message.*

### 2. Usage
1.  **Launch the Tool:** Double-click **`Launch_GUI.bat`**.
2.  **Get Template:** Click the **"üìÑ Get New Template"** button in the dashboard.
3.  **Enter Data:** Open `SPC-DATA_Input_Template.xlsx` and fill in your data. Save it with the `SPC-DATA_` prefix (e.g., `SPC-DATA_Lot55.xlsx`).
4.  **Refresh:** Click **"üîÑ Refresh File List"** in the tool to see your new file.
5.  **Select Project:**
    * Type a **New Name** to create a fresh folder.
    * OR Select an **Existing Project** from the dropdown to update it.
6.  **Run:** Click **"‚ñ∂ RUN ANALYSIS"**.

---

## üìê Mathematical Summary

### 1. Variable Data (Numeric)
The tool treats the input data as a single continuous population.
* **Standard Deviation ($\sigma$):** The tool calculates the **Sample Standard Deviation** of the entire dataset (Overall Variation).
    $$\hat{\sigma} = \sqrt{\frac{\sum(x_i - \bar{x})^2}{N-1}}$$
    *Note: Because this uses the total standard deviation rather than within-subgroup variation ($\bar{R}/d_2$), the reported "Cpk" is statistically equivalent to **Ppk** (Process Performance).*

* **Process Capability ($C_{pk}$):**
    $$C_{pu} = \frac{USL - \bar{x}}{3\sigma}$$
    $$C_{pl} = \frac{\bar{x} - LSL}{3\sigma}$$
    $$C_{pk} = \min(C_{pu}, C_{pl})$$

### 2. Attribute Data (Pass/Fail)
If a column contains text (non-numeric data), the tool switches to Attribute Mode.
* **Data Transformation:**
    * `PASS`, `OK`, `GOOD` $\rightarrow$ **1**
    * `FAIL`, `NOK`, `BAD` $\rightarrow$ **0**
* **Failure Rate:**
    $$Rate (\%) = \left( \frac{\text{Count of Fails}}{\text{Total Samples}} \right) \times 100$$

---

## üìÇ Project Structure

* `Launch_GUI.bat` - **Entry Point:** Double-click this to start.
* `SPC_Tool_GUI.pyw` - The Python code for the dashboard interface.
* `install.bat` - One-time installer script.
* `input/` - Place your `SPC-DATA_*.xlsx` files here (root folder).
* `output/` - Reports generated here, organized by Project Name.
* `src/` - Core Python backend logic.

---

## üõ°Ô∏è Troubleshooting

| Issue | Solution |
| :--- | :--- |
| **Window does not appear** | Ensure you ran `install.bat` first. If it still fails, check if `crash_log.txt` was created in the folder. |
| **"Python not found"** | Re-install Python and ensure "Add to PATH" is checked during installation. |
| **"Permission Error"** | You have the Excel file open. Close it and try again. |
| **"No input files found"** | Your files must start with `SPC-DATA_` and be in the same folder as the script. |

---

## üí° Advanced Features

* **Split Data:** If you have a process change (e.g., tool swap), type `SPLIT` into a data cell in Excel. The charts will visually break at that point.
* **Mixed Data:** You can mix numeric columns (Dimensions) and attribute columns (Visual Checks) in the same spreadsheet. The tool handles them automatically.